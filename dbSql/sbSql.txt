CREATE DATABASE IF NOT EXISTS geekcs_res;
USE geekcs_res;


DROP TABLE IF EXISTS user;
CREATE TABLE IF NOT EXISTS user(
	id INT UNSIGNED AUTO_INCREMENT KEY,
	name VARCHAR(32) NOT NULL UNIQUE,
	password CHAR(32) NOT NULL,
	sick_name VARCHAR(32),
	photo VARCHAR(64),
	email VARCHAR(32) NOT NULL,
	role_id SMALLINT NOT NULL DEFAULT 2,
	introdution VARCHAR(255),
	create_time INT UNSIGNED NOT NULL DEFAULT 0
	
);


DROP TABLE IF EXISTS role;
CREATE TABLE IF NOT EXISTS role(
	id SMALLINT UNSIGNED AUTO_INCREMENT KEY,
	name VARCHAR(32) NOT NULL UNIQUE,
	introdution VARCHAR(255),
	create_time INT UNSIGNED NOT NULL DEFAULT 0
	
);


DROP TABLE IF EXISTS role_relate_power;
CREATE TABLE IF NOT EXISTS role_relate_power(
	id SMALLINT UNSIGNED AUTO_INCREMENT KEY,
	role_id SMALLINT NOT NULL,
	power_id SMALLINT NOT NULL,
	create_time INT UNSIGNED NOT NULL DEFAULT 0
	
);

DROP TABLE IF EXISTS role_relate_power;
CREATE TABLE IF NOT EXISTS power(
	id SMALLINT UNSIGNED AUTO_INCREMENT KEY,
	name VARCHAR(32) NOT NULL UNIQUE,
	power_func VARCHAR(32) NOT NULL UNIQUE,
	create_time INT UNSIGNED NOT NULL DEFAULT 0	
);


DROP TABLE IF EXISTS short_res;
CREATE TABLE IF NOT EXISTS short_res(
	id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
	name VARCHAR(32) NOT NULL,
	url VARCHAR(255) NOT NULL,
	introdution VARCHAR(255) NOT NULL,
	photo VARCHAR(64) NOT NULL, 
	res_sort_id  SMALLINT NOT NULL,
	res_sort_name VARCHAR(32) NOT NULL,
	tag VARCHAR(64),
	praise_num INT UNSIGNED NOT NULL DEFAULT 0,
	user_id INT NOT NULL,
	user_sick_name VARCHAR(32),
	is_pass TINYINT(1) NOT NULL DEFAULT 1,
	is_delete TINYINT(1) NOT NULL DEFAULT 1,
	create_time INT UNSIGNED NOT NULL DEFAULT 0
);

DROP TABLE IF EXISTS res_sort;
CREATE TABLE IF NOT EXISTS res_sort(
	id SMALLINT UNSIGNED AUTO_INCREMENT KEY,
	name VARCHAR(32) NOT NULL
);

DROP TABLE IF EXISTS res_deep_sort;
CREATE TABLE IF NOT EXISTS res_deep_sort(
	id SMALLINT UNSIGNED AUTO_INCREMENT KEY,
	name VARCHAR(32) NOT NULL,
	res_sort_id SMALLINT NOT NULL
);

INSERT role(id,name,introdution) VALUES(1,'超级管理员',''),(2,'用户','');
INSERT user(id,name,password,sick_name,photo,email,role_id,introdution) VALUES(1,'ScauZhang','202cb962ac59075b964b07152d234b70','张大哥','#','920304092@qq.com',1,'风继续吹');